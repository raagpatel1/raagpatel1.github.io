<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Raag Patel and Andrew Taylor" />


<title>Project 1 FInal RCode Full Analysis</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My-Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="Project1.html">Project1</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Project 1 FInal RCode Full Analysis</h1>
<h4 class="author">Raag Patel and Andrew Taylor</h4>
<h4 class="date">1/2/2022</h4>

</div>


<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.6     v dplyr   1.0.7
## v tidyr   1.1.4     v stringr 1.4.0
## v readr   2.1.1     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(dplyr)
library(readr)
library(ggplot2)
library(plotly)</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<pre class="r"><code>library(GGally)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre class="r"><code>library(cowplot)
library(ggpubr)</code></pre>
<pre><code>## 
## Attaching package: &#39;ggpubr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:cowplot&#39;:
## 
##     get_legend</code></pre>
<pre class="r"><code>library(devtools)</code></pre>
<pre><code>## Loading required package: usethis</code></pre>
<pre class="r"><code>library(ggcorrplot)
library(ggfittext)
library(class)
library(caret)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre class="r"><code>library(e1071)
library(usmap)


############################## INTRODUCTION ####################################
#
# This R markdown file will answer the 9 questions &quot;asked&quot; by the&quot;Budweiser CEO 
# and CFO using the provided Beer and Breweries data sets.  We will first import
# and summarize the data to check for any apparent anomalies before organizing
# with the use of tidyverse. From there we will address each question broken up
# into Parts 1 - 9, each with step by step comments and a final conclusion.
#
############################## INTRODUCTION ####################################


## Read in the .csv&#39;s

Beer = read_csv(&quot;Beers.csv&quot;)</code></pre>
<pre><code>## Rows: 2410 Columns: 7</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (2): Name, Style
## dbl (5): Beer_ID, ABV, IBU, Brewery_id, Ounces</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>Brewery = read_csv(&quot;Breweries.csv&quot;)</code></pre>
<pre><code>## Rows: 558 Columns: 4</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (3): Name, City, State
## dbl (1): Brew_ID</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>## Of course you&#39;ll need to change the above part to match your system


################################### PART 2 #####################################
#
# 2. Merge beer data with the breweries data. Print the first 6 observations and
# the last six observations to check the merged file.
#
################################### PART 2 #####################################

# Renamed the &#39;name&#39; columns, as they were the same in both .csv files, which 
# were hard to distinguish when the tables combined. 
colnames(Beer)[1] = &quot;Beer_Name&quot;
colnames(Brewery)[2] = &quot;Brewery_Name&quot;

# Used a full join to make sure all data is accurately represented. 
BB = full_join(Beer,Brewery,by = c(&quot;Brewery_id&quot; = &quot;Brew_ID&quot;))

# A filtered dataset of BB
BB_F = BB %&gt;% drop_na(IBU,ABV,Style)

# Inspecting the top and bottom of our new dataframe
head(BB,6)</code></pre>
<pre><code>## # A tibble: 6 x 10
##   Beer_Name Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery_Name City  State
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;
## 1 Pub Beer     1436 0.05     NA        409 Amer~     12 10 Barrel B~ Bend  OR   
## 2 Devil&#39;s ~    2265 0.066    NA        178 Amer~     12 18th Street~ Gary  IN   
## 3 Rise of ~    2264 0.071    NA        178 Amer~     12 18th Street~ Gary  IN   
## 4 Sinister     2263 0.09     NA        178 Amer~     12 18th Street~ Gary  IN   
## 5 Sex and ~    2262 0.075    NA        178 Amer~     12 18th Street~ Gary  IN   
## 6 Black Ex~    2261 0.077    NA        178 Oatm~     12 18th Street~ Gary  IN</code></pre>
<pre class="r"><code>tail(BB,6)</code></pre>
<pre><code>## # A tibble: 6 x 10
##   Beer_Name Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery_Name City  State
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;
## 1 Rocky Mo~    1035 0.075    NA        425 Amer~     12 Wynkoop Bre~ Denv~ CO   
## 2 Belgorado     928 0.067    45        425 Belg~     12 Wynkoop Bre~ Denv~ CO   
## 3 Rail Yar~     807 0.052    NA        425 Amer~     12 Wynkoop Bre~ Denv~ CO   
## 4 B3K Blac~     620 0.055    NA        425 Schw~     12 Wynkoop Bre~ Denv~ CO   
## 5 Silverba~     145 0.055    40        425 Amer~     12 Wynkoop Bre~ Denv~ CO   
## 6 Rail Yar~      84 0.052    NA        425 Amer~     12 Wynkoop Bre~ Denv~ CO</code></pre>
<pre class="r"><code>############################### PART 2 CONCLUSION ##############################
#
# Upon inspection of the head and tail of the merged data frame, 
# everything appears to have joined successfully.
#
############################### PART 2 CONCLUSION ##############################



################################### PART 1 #####################################
#
# 1. How many breweries are present in each state?
#
################################### PART 1 #####################################

# Create set from Brewery data to total the number of Breweries in each state
by_State &lt;- as.data.frame(table(Brewery$State))

# Rename columns to better reflect specific purpose of this data 
colnames(by_State) = c(&quot;State&quot;, &quot;Amount&quot;)

# Arrange the set in descending order
by_State &lt;- arrange(by_State, desc(Amount))

# print top 10 states with most breweries
TopTen = head(by_State,10)
TopTen</code></pre>
<pre><code>##    State Amount
## 1     CO     47
## 2     CA     39
## 3     MI     32
## 4     OR     29
## 5     TX     28
## 6     PA     25
## 7     MA     23
## 8     WA     23
## 9     IN     22
## 10    WI     20</code></pre>
<pre class="r"><code># print bottom 10 states with least breweries
LastTen = tail(by_State,10)
LastTen</code></pre>
<pre><code>##    State Amount
## 42    NJ      3
## 43    TN      3
## 44    AR      2
## 45    DE      2
## 46    MS      2
## 47    NV      2
## 48    DC      1
## 49    ND      1
## 50    SD      1
## 51    WV      1</code></pre>
<pre class="r"><code># gradient colored bar plot of same data in descending order
by_State %&gt;% 
  ggplot(aes(x = reorder(State, -Amount), y = Amount, fill = Amount)) + 
  geom_bar(stat=&quot;identity&quot;) +
  scale_fill_gradient2(low = &quot;yellow&quot;, 
                       high = &quot;red&quot;, 
                       midpoint = median(by_State$Amount)) + 
  labs(title=&quot;Number of Breweries per State&quot;, x=&quot;State&quot;, y=&quot;No. of Breweries&quot;) +
  ylim(0, 50)+
  scale_x_discrete(limits = by_State$State) +
  theme(axis.text.x = element_text(vjust = grid::unit(c(-4, -2, 0), &quot;points&quot;)))</code></pre>
<pre><code>## Warning: Vectorized input to `element_text()` is not officially supported.
## Results may be unexpected or may change in future versions of ggplot2.</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>############################### PART 1 CONCLUSION ##############################
#
# The 10 States with the most number of Breweries are: Colorado (47), 
# California (39), Michigan (32), Oregon (29), Texas (28), Pennsylvania (25), 
# Massachusetts (23), Washington (23), Indiana (22), and Wisconsin (20).        
# The 10 States with the least number of Breweries are: West Virginia (1), 
# South Dakota (1), North Dakota (1), District of Columbia (1), Nevada (2), 
# Mississippi (2), Delaware (2), Arkansas (2), Tennessee (3), and New Jersey (3).
#
############################### PART 1 CONCLUSION ##############################



################################### PART 3 #####################################
#
# 3. Address the missing values in each column.
#
################################### PART 3 #####################################

# Create 2 additional data sets, one with by dropping the ABV N/A values and 
# the other dropping the IBU N/A values 
BB_ABV = BB %&gt;% drop_na(ABV,Style)
BB_IBU = BB %&gt;% drop_na(IBU,Style)
BB_Both = BB %&gt;% drop_na(IBU,ABV,Style)

# Check summaries of each data set to look for N/A values
summary(Beer)</code></pre>
<pre><code>##   Beer_Name            Beer_ID            ABV               IBU        
##  Length:2410        Min.   :   1.0   Min.   :0.00100   Min.   :  4.00  
##  Class :character   1st Qu.: 808.2   1st Qu.:0.05000   1st Qu.: 21.00  
##  Mode  :character   Median :1453.5   Median :0.05600   Median : 35.00  
##                     Mean   :1431.1   Mean   :0.05977   Mean   : 42.71  
##                     3rd Qu.:2075.8   3rd Qu.:0.06700   3rd Qu.: 64.00  
##                     Max.   :2692.0   Max.   :0.12800   Max.   :138.00  
##                                      NA&#39;s   :62        NA&#39;s   :1005    
##    Brewery_id       Style               Ounces     
##  Min.   :  1.0   Length:2410        Min.   : 8.40  
##  1st Qu.: 94.0   Class :character   1st Qu.:12.00  
##  Median :206.0   Mode  :character   Median :12.00  
##  Mean   :232.7                      Mean   :13.59  
##  3rd Qu.:367.0                      3rd Qu.:16.00  
##  Max.   :558.0                      Max.   :32.00  
## </code></pre>
<pre class="r"><code>summary(Brewery)</code></pre>
<pre><code>##     Brew_ID      Brewery_Name           City              State          
##  Min.   :  1.0   Length:558         Length:558         Length:558        
##  1st Qu.:140.2   Class :character   Class :character   Class :character  
##  Median :279.5   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :279.5                                                           
##  3rd Qu.:418.8                                                           
##  Max.   :558.0</code></pre>
<pre class="r"><code>summary(BB)</code></pre>
<pre><code>##   Beer_Name            Beer_ID            ABV               IBU        
##  Length:2410        Min.   :   1.0   Min.   :0.00100   Min.   :  4.00  
##  Class :character   1st Qu.: 808.2   1st Qu.:0.05000   1st Qu.: 21.00  
##  Mode  :character   Median :1453.5   Median :0.05600   Median : 35.00  
##                     Mean   :1431.1   Mean   :0.05977   Mean   : 42.71  
##                     3rd Qu.:2075.8   3rd Qu.:0.06700   3rd Qu.: 64.00  
##                     Max.   :2692.0   Max.   :0.12800   Max.   :138.00  
##                                      NA&#39;s   :62        NA&#39;s   :1005    
##    Brewery_id       Style               Ounces      Brewery_Name      
##  Min.   :  1.0   Length:2410        Min.   : 8.40   Length:2410       
##  1st Qu.: 94.0   Class :character   1st Qu.:12.00   Class :character  
##  Median :206.0   Mode  :character   Median :12.00   Mode  :character  
##  Mean   :232.7                      Mean   :13.59                     
##  3rd Qu.:367.0                      3rd Qu.:16.00                     
##  Max.   :558.0                      Max.   :32.00                     
##                                                                       
##      City              State          
##  Length:2410        Length:2410       
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
##                                       
## </code></pre>
<pre class="r"><code>summary(BB_ABV)</code></pre>
<pre><code>##   Beer_Name            Beer_ID            ABV               IBU        
##  Length:2346        Min.   :   1.0   Min.   :0.00100   Min.   :  4.00  
##  Class :character   1st Qu.: 827.2   1st Qu.:0.05000   1st Qu.: 21.00  
##  Mode  :character   Median :1462.5   Median :0.05600   Median : 35.00  
##                     Mean   :1438.8   Mean   :0.05978   Mean   : 42.74  
##                     3rd Qu.:2077.8   3rd Qu.:0.06700   3rd Qu.: 64.00  
##                     Max.   :2692.0   Max.   :0.12800   Max.   :138.00  
##                                                        NA&#39;s   :943     
##    Brewery_id       Style               Ounces      Brewery_Name      
##  Min.   :  1.0   Length:2346        Min.   : 8.40   Length:2346       
##  1st Qu.: 94.0   Class :character   1st Qu.:12.00   Class :character  
##  Median :206.0   Mode  :character   Median :12.00   Mode  :character  
##  Mean   :231.4                      Mean   :13.59                     
##  3rd Qu.:366.0                      3rd Qu.:16.00                     
##  Max.   :558.0                      Max.   :32.00                     
##                                                                       
##      City              State          
##  Length:2346        Length:2346       
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
##                                       
## </code></pre>
<pre class="r"><code>summary(BB_IBU)</code></pre>
<pre><code>##   Beer_Name            Beer_ID          ABV               IBU        
##  Length:1403        Min.   :   1   Min.   :0.02700   Min.   :  4.00  
##  Class :character   1st Qu.: 771   1st Qu.:0.05000   1st Qu.: 21.00  
##  Mode  :character   Median :1435   Median :0.05700   Median : 35.00  
##                     Mean   :1414   Mean   :0.05992   Mean   : 42.74  
##                     3rd Qu.:2068   3rd Qu.:0.06800   3rd Qu.: 64.00  
##                     Max.   :2692   Max.   :0.12500   Max.   :138.00  
##    Brewery_id       Style               Ounces      Brewery_Name      
##  Min.   :  1.0   Length:1403        Min.   : 8.40   Length:1403       
##  1st Qu.: 96.5   Class :character   1st Qu.:12.00   Class :character  
##  Median :199.0   Mode  :character   Median :12.00   Mode  :character  
##  Mean   :224.4                      Mean   :13.51                     
##  3rd Qu.:351.0                      3rd Qu.:16.00                     
##  Max.   :547.0                      Max.   :32.00                     
##      City              State          
##  Length:1403        Length:1403       
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
## </code></pre>
<pre class="r"><code># Count the number of rows with ABV N/A values
sum(is.na(BB$ABV))</code></pre>
<pre><code>## [1] 62</code></pre>
<pre class="r"><code># Count the number of rows with ABV N/A values after N/A are dropped
sum(is.na(BB_ABV$ABV))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code># Count the number of rows with ABV N/A values
sum(is.na(BB$IBU))</code></pre>
<pre><code>## [1] 1005</code></pre>
<pre class="r"><code># Count the number of rows with ABV N/A values after N/A are dropped
sum(is.na(BB_IBU$IBU))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>############################### PART 3 CONCLUSION ##############################
#
# We created 3 new data sets all with specific further analysis in mind
# There are a small number of beer entries which do no have a &quot;Style&quot; associated 
# with them.  As much of our analysis will be utilizing the &quot;Style&quot; to better 
# group the beers, we will exclude these N/A values in all 3 new data sets. 
# When exploring the ABV relationship and distribution, we will use the BB_ABV 
# set which excludes all N/A ABV entries. Alcohol by Volume is required to be on
# all beers in the United States be law.  The fact some of the entries are missing 
# these values leads us to question the accuracy of those entries.
# When exploring the IBU relationship and distribution, we will use the BB_IBU 
# set which excludes all N/A ABV entries. IBU is not required by law but rather an 
# informative metric of bitterness for the consumer.  Unless specifically digging 
# into the IBU values, we are comfortable using entries that do not have an IBU 
# listed. When exploring the relationship BETWEEN ABV and IBU, we will use the 
# BB_Both set which excludes all entries that have N/A for ABV OR IBU OR both.
#
############################### PART 3 CONCLUSION ############################## 



################################### PART 4 #####################################
#
# 4. Compute the median alcohol content and international bitterness unit for
# each state. Plot a bar chart to compare.
#
################################### PART 4 #####################################

# Here we take the filtered data sets previously created, group the data by each 
# state, then take the necessary summary.
# The data is then organized, so that the highest/lowest value is at the top
# and we can slice the data frame to show exactly what we want. Then
# we use standard ggplot functions, where we also reorder the bars for 
# readability. 

## Highest median ABV by state using the data set which excludes N/A ABV values.
g1 = BB_ABV %&gt;% group_by(State) %&gt;% summarise(Median_ABV = median(ABV)) %&gt;% 
  arrange(desc(Median_ABV)) %&gt;% slice(1:10) %&gt;%
  ggplot(aes(reorder(State,-Median_ABV), y = Median_ABV, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;States Highest Median ABV&quot;, x=&quot;State&quot;, y=&quot;Median ABV&quot;) + 
  geom_text(aes(label = round(Median_ABV,digits = 4)), vjust = -.5) + 
  theme(legend.position=&quot;none&quot;) + ylim(0,.065)

## Lowest median ABV by state using the data set which excludes N/A ABV values.
g2 = BB_ABV %&gt;% group_by(State) %&gt;% summarise(Median_ABV = median(ABV)) %&gt;% 
  arrange((Median_ABV)) %&gt;% slice(1:10) %&gt;%
  ggplot(aes(reorder(State,-Median_ABV), y = Median_ABV, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;States Lowest Median ABV&quot;, x=&quot;State&quot;, y=&quot;Median ABV&quot;) + 
  geom_text(aes(label = round(Median_ABV,digits = 4)), vjust = -.5) + 
  theme(legend.position=&quot;none&quot;)+ ylim(0,.065)

## Highest median IBU by state using the data set which excludes N/A ABV values.
g3 = BB_IBU %&gt;% group_by(State) %&gt;% summarise(Median_IBU = median(IBU)) %&gt;% 
  arrange(desc(Median_IBU)) %&gt;% slice(1:10) %&gt;%
  ggplot(aes(reorder(State,-Median_IBU), y = Median_IBU, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;States Highest Median IBU&quot;, x=&quot;State&quot;, y=&quot;Median IBU&quot;) + 
  geom_text(aes(label = round(Median_IBU,digits = 4)), vjust = -.5) + 
  theme(legend.position=&quot;none&quot;) + ylim(0,65)

## Lowest median IBU by state using the data set which excludes N/A ABV values.
g4 = BB_IBU %&gt;% group_by(State) %&gt;% summarise(Median_IBU = median(IBU)) %&gt;% 
  arrange((Median_IBU)) %&gt;% slice(1:10) %&gt;%
  ggplot(aes(reorder(State,Median_IBU), y = Median_IBU, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;States Lowest Median IBU&quot;, x=&quot;State&quot;, y=&quot;Median IBU&quot;) + 
  geom_text(aes(label = round(Median_IBU,digits = 4)), vjust = -.5) + 
  theme(legend.position=&quot;none&quot;) + ylim(0,32)

## Show the plots on one page 
ggarrange(g1,g2,g3,g4, ncol = 2, nrow = 2)</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>############################### PART 4 CONCLUSION ##############################
#
# The 10 States with the highest median ABV are: DC (6.3%), KY (6.3%), MI (6.2%), 
# NM (6.2%), WV (6.2%), CO (6.1%), AL (6.0%), CT (6.0%), NV (6.0%), and OK (6.0%).      
# The 10 States with the lowest median ABV are: UT (4.0%), NJ (4.6%), WY (5.0%), 
# ND (5.0%), KS (5.0%), ME (5.1%), WI (5.2%), MO (5.2%), LA (5.2%), and AR (5.2%).
# The 10 States with the highest median IBU are: ME (61), WV (56), FL (55), 
# GA (55), DE (52), NM (51), NH (49), DC (48), NY (47), and AK (46).
# The 10 States with the lowest median IBU are: WI (19), KS (20), AZ (21), 
# WY (21), HI (23), MO (24), RI (24), IA (26), CT (29), and MD (29).
#
############################### PART 4 CONCLUSION ##############################



################################### PART 5 #####################################
# 
# 5. Which state has the maximum alcoholic (ABV) beer? Which state has the most
# bitter (IBU) beer?
# 
################################### PART 5 #####################################

# Using the BB_ABV data set we search for the lowest ABV value recorded and 
# check it&#39;s brewery/state
MinABV = which.min(BB_ABV$ABV)
BB_ABV[MinABV,]</code></pre>
<pre><code>## # A tibble: 1 x 10
##   Beer_Name Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery_Name City  State
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;
## 1 Scotty K~     606 0.001    NA        523 Low ~     16 Uncommon Br~ Sant~ CA</code></pre>
<pre class="r"><code># Using the BB_ABV data set we search for the highest ABV value recorded and 
# check it&#39;s brewery/state 
MaxABV = which.max(BB_ABV$ABV)
BB_ABV[MaxABV,]</code></pre>
<pre><code>## # A tibble: 1 x 10
##   Beer_Name Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery_Name City  State
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;
## 1 Lee Hill~    2565 0.128    NA         52 Quad~   19.2 Upslope Bre~ Boul~ CO</code></pre>
<pre class="r"><code># Using the BB_ABV data set we search for the lowest IBU value recorded and 
# check it&#39;s brewery/state
MinIBU = which.min(BB_IBU$IBU)
BB_IBU[MinIBU,]</code></pre>
<pre><code>## # A tibble: 1 x 10
##   Beer_Name Beer_ID   ABV   IBU Brewery_id Style Ounces Brewery_Name City  State
##   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;
## 1 Summer S~    1350 0.056     4        172 Crea~     12 Anderson Va~ Boon~ CA</code></pre>
<pre class="r"><code># Using the original/unfiltered data set we search for the highest ABV value 
# recorded and check it&#39;s brewery/state 
MaxIBU = which.max(BB_IBU$IBU)
BB_IBU</code></pre>
<pre><code>## # A tibble: 1,403 x 10
##    Beer_Name    Beer_ID   ABV   IBU Brewery_id Style   Ounces Brewery_Name City 
##    &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;
##  1 Bitter Bitch    1979 0.061    60        178 Americ~   12   18th Street~ Gary 
##  2 Lower De Bo~    1036 0.099    92        369 Americ~    8.4 21st Amendm~ San ~
##  3 Fireside Ch~    1024 0.079    45        369 Winter~   12   21st Amendm~ San ~
##  4 Bitter Amer~     876 0.044    42        369 Americ~   12   21st Amendm~ San ~
##  5 Hell or Hig~     802 0.049    17        369 Fruit ~   12   21st Amendm~ San ~
##  6 Hell or Hig~     801 0.049    17        369 Fruit ~   12   21st Amendm~ San ~
##  7 21st Amendm~     800 0.049    17        369 Fruit ~   12   21st Amendm~ San ~
##  8 21st Amendm~     799 0.07     70        369 Americ~   12   21st Amendm~ San ~
##  9 Brew Free! ~     797 0.07     70        369 Americ~   12   21st Amendm~ San ~
## 10 Brew Free! ~     796 0.07     70        369 Americ~   12   21st Amendm~ San ~
## # ... with 1,393 more rows, and 1 more variable: State &lt;chr&gt;</code></pre>
<pre class="r"><code># Plot the top 5 states with the highest ABV (1 per state)
g5 = BB_ABV %&gt;% group_by(State) %&gt;% 
  summarise(Max_ABV = max(ABV),Beer_Name = Beer_Name[1]) %&gt;%
  arrange(desc(Max_ABV)) %&gt;% 
  slice(1:5) %&gt;% 
  ggplot(aes(reorder(State,-Max_ABV), y = Max_ABV, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;Highest Single ABV&quot;, x=&quot;State&quot;, y=&quot;ABV&quot;) + 
  geom_text(aes(label = round(Max_ABV,digits = 5)), vjust = -.5) +
  geom_text(aes(label = Beer_Name, vjust = -2), check_overlap = T) +
  theme(legend.position=&quot;none&quot;) +
  coord_cartesian(ylim = c(.05,.15))

# Plot the bottom 5 states with the lowest ABV (1 per state)
g6 = BB_ABV %&gt;% group_by(State) %&gt;% 
  summarise(min_ABV = min(ABV),Beer_Name = Beer_Name[1]) %&gt;%
  arrange(desc(min_ABV)) %&gt;% 
  slice(1:5) %&gt;% 
  ggplot(aes(reorder(State,-min_ABV), y = min_ABV, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;Lowest Single ABV&quot;, x=&quot;State&quot;, y=&quot;ABV&quot;) + 
  geom_text(aes(label = round(min_ABV,digits = 5)), vjust = -.5) +
  geom_text(aes(label = Beer_Name, vjust = -2), check_overlap = T) +
  theme(legend.position=&quot;none&quot;) +
  coord_cartesian(ylim = c(.0,.065))

# Plot the bottom 5 states with the highest IBU (1 per state)
g7 = BB_IBU %&gt;% group_by(State) %&gt;% 
  summarise(Max_IBU = max(IBU),Beer_Name = Beer_Name[1]) %&gt;%
  arrange(desc(Max_IBU)) %&gt;% 
  slice(1:5) %&gt;% 
  ggplot(aes(reorder(State,-Max_IBU), y = Max_IBU, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;Highest Single IBU&quot;, x=&quot;State&quot;, y=&quot;IBU&quot;) + 
  geom_text(aes(label = round(Max_IBU,digits = 5)), vjust = -.5) +
  geom_text(aes(label = Beer_Name, vjust = -2), check_overlap = T) +
  theme(legend.position=&quot;none&quot;) +
  coord_cartesian(ylim = c(0,150))

# Plot the bottom 5 states with the lowest IBU (1 per state)
g8 = BB_IBU %&gt;% group_by(State) %&gt;% 
  summarise(min_IBU = min(IBU),Beer_Name = Beer_Name[1]) %&gt;%
  arrange(desc(min_IBU)) %&gt;% 
  slice(1:5) %&gt;% 
  ggplot(aes(reorder(State,min_IBU), y = min_IBU, fill = State)) + 
  geom_bar(stat = &quot;identity&quot;) +  
  labs(title=&quot;Lowest Single IBU&quot;, x=&quot;State&quot;, y=&quot;IBU&quot;) + 
  geom_text(aes(label = round(min_IBU,digits = 5)), vjust = -.5) +
  geom_text(aes(label = Beer_Name, vjust = -2), check_overlap = T) +
  theme(legend.position=&quot;none&quot;) +
  coord_cartesian(ylim = c(0,55))

## Show the plots on one page 
ggarrange(g5,g6,g7,g8, ncol = 2, nrow = 2)</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
<pre class="r"><code>############################### PART 5 CONCLUSION ##############################
#
# The highest ABV beer comes in at 12.8% Alcohol by Volume.  The beer is called 
# &quot;Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale&quot; and is brewed at Upslope 
# Brewing Company in Boulder Colorado.
# The highest IBU beer comes in at a bitterness of 138.  The beer is called 
# &quot;Bitter Bitch Imperial IPA&quot; and is brewed at Astoria Brewing Company 
# in Astoria, Oregon.
#
############################### PART 5 CONCLUSION ##############################



################################### PART 6 #####################################
# 
# 6. Comment on the summary statistics and distribution of the ABV variable.
# 
################################### PART 6 #####################################

# Using the integrated region database in R, we created a dataframe where we took
# the abbreviated state name and it&#39;s corresponding region, then using a left
# join we were able to associate a region with it&#39;s corresponding state.

State_Region = data.frame(state.abb, state.region)
BB_F_Region = left_join(BB_F,State_Region, by = c(&quot;State&quot; = &quot;state.abb&quot;))

# sum(is.na(BB_F_Region$state.region))
# [1] 0

 
# Filling in the bars with the corresponding region vs the corresponsing state,
# allows for more inferences to be made, and is much easier to read.

g9 = BB_F_Region %&gt;% drop_na() %&gt;% ggplot(aes(x = ABV, fill = state.region)) + 
  geom_histogram(color = &#39;black&#39;) + 
  labs(title=&quot;Distribution of ABV&quot;, x=&quot;ABV&quot;, y=&quot;Number of Beers&quot;)

g10 = BB_F_Region %&gt;% ggplot(aes(x = ABV)) + geom_histogram(color = &#39;blue&#39;) + 
  labs(title=&quot;Distribution of ABV&quot;, x=&quot;ABV&quot;, y=&quot;Number of Beers&quot;)

g11 = BB_F_Region %&gt;% ggplot(aes(x = ABV)) + geom_line(aes(fill=..count..),stat=&quot;bin&quot;) + 
  labs(title=&quot;Distribution of ABV&quot;, x=&quot;ABV&quot;, y=&quot;Number of Beers&quot;)</code></pre>
<pre><code>## Warning: Ignoring unknown aesthetics: fill</code></pre>
<pre class="r"><code>g12 = BB_F_Region %&gt;% ggplot(aes(x = ABV)) + geom_boxplot()

summary(BB_F$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.02700 0.05000 0.05700 0.05992 0.06800 0.12500</code></pre>
<pre class="r"><code>## Show the plots on one page 
ggarrange(g9,g10,g11,g12, ncol = 2, nrow = 2)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-4.png" width="672" /></p>
<pre class="r"><code>############################### PART 6 CONCLUSION ##############################
#
# Plotting the ABV distribution for all beers which have a valid ABV entry, 
# we get a right-tailed distribution centered around a mean of ABV = 5.97%. 
# The middle 50% of the distribution (Q25% to Q75%) has an ABV range of only 1.7%.
# The median  of the distribution is 5.6%, slightly lower than the mean and more 
# indicative of the plot&#39;s main high point. 
#
############################### PART 6 CONCLUSION ##############################



################################### PART 7 #####################################
# 
# 7. Is there an apparent relationship between the bitterness of the beer and 
# its alcoholic content? Draw a scatter plot. Make your best judgment of a 
# relationship and EXPLAIN your answer.
# 
################################### PART 7 #####################################


ABVvsIBU = BB_Both %&gt;% select(ABV,IBU)

corr = round(cor(ABVvsIBU),2)

head(corr)</code></pre>
<pre><code>##      ABV  IBU
## ABV 1.00 0.67
## IBU 0.67 1.00</code></pre>
<pre class="r"><code>ggplot(ABVvsIBU, aes(x = ABV, y = IBU)) + geom_point() +
  stat_cor(label.x = .03, label.y = 150) +
  geom_smooth(method = lm, se=FALSE) + geom_smooth(se = FALSE, color = &quot;red&quot;) </code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-5.png" width="672" /></p>
<pre class="r"><code>############################### PART 7 CONCLUSION ##############################
#
# There is evidence to support a 67% positive correlation between the ABV and 
# IBU of a beer.  Both a straight line and fitted line illustrate this 
# relationship when applied to the scatter plot of data points.  
#
############################### PART 7 CONCLUSION ##############################



################################### PART 8 #####################################
# 
# 8. Budweiser would also like to investigate the difference with respect to IBU 
# and ABV between IPAs (India Pale Ales) and other types of Ale (any beer with 
# &quot;Ale&quot; in its name other than IPA). You decide to use KNN classification to 
# investigate this relationship. Provide statistical evidence one way or the 
# other. You can of course assume your audience is comfortable with percentages.
# KNN is very easy to understand conceptually. 
#
# In addition, while you have decided to use KNN to investigate this 
# relationship (KNN is required) you may also feel free to supplement your 
# response to this question with any other methods or techniques you have 
# learned. Creativity and alternative solutions are always encouraged. 
# 
################################### PART 8 #####################################


# Starting with the filtered data set which removed N/A&#39;s for both ABV and IBU, 
# we create 3 data sets.

# BB_Ale contains all the beers that contain the word &quot;Ale&quot; in its &quot;Style&quot; 
# description and sets it&#39;s type as &quot;Ale&quot;
BB_Ale = BB_Both[str_detect(BB_Both$Style, &quot;Ale&quot;), ] %&gt;% add_column(Type = &quot;Ale&quot;)

# BB_IPA contains all the beers that contain the word &quot;IPA&quot; in its &quot;Style&quot; 
# description and sets it&#39;s type as &quot;IPA&quot;
BB_IPA = BB_Both[str_detect(BB_Both$Style, &quot;IPA&quot;), ] %&gt;% add_column(Type = &quot;IPA&quot;)

# BB_Type combines the 2 previous data sets to include all beers that have a 
# Type of &quot;Ale&quot; or &quot;IPA&quot;
BB_Type &lt;- rbind(BB_Ale, BB_IPA)

# Plot the new data set in a scatterplot to visualize and color code by Type
ggplot(BB_Type, aes(x = ABV, y = IBU, color = Type)) + geom_point() + 
  stat_cor() + geom_smooth(method = lm, se=FALSE)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-6.png" width="672" /></p>
<pre class="r"><code># Create a double fo loop that splits the new BB_Type data set into a test and 
# train set, then runs 100 iterations using k values between 1 and 50 to find 
# the best fit k-value
iterations = 100
numks = 50
splitPerc = .8
masterAcc = matrix(nrow = iterations, ncol = numks)
for(j in 1:iterations)
{
  trainIndices = sample(1:dim(BB_Type)[1],round(splitPerc * dim(BB_Type)[1]))
  BB_Type_train = BB_Type[trainIndices,]
  BB_Type_test = BB_Type[-trainIndices,]
  for(i in 1:numks)
  {
    classifications = knn(BB_Type_train[,c(3,4)],BB_Type_test[,c(3,4)],
                          BB_Type_train$Type, prob = TRUE, k = i)
    table(classifications,BB_Type_test$Type)
    CM = confusionMatrix(table(classifications,BB_Type_test$Type))
    masterAcc[j,i] = CM$overall[1]
  }
  
}
MeanAcc = colMeans(masterAcc)
plot(seq(1,numks,1),MeanAcc, type = &quot;l&quot;)</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-7.png" width="672" /></p>
<pre class="r"><code># Output the best k-value from the loop
which.max(MeanAcc)</code></pre>
<pre><code>## [1] 6</code></pre>
<pre class="r"><code># Output the Accuracy of the knn classification using the best k-value
max(MeanAcc)</code></pre>
<pre><code>## [1] 0.8538947</code></pre>
<pre class="r"><code># create a final confusion matrix using the best k-value
classifications = knn(BB_Type_train[,c(3,4)],BB_Type_test[,c(3,4)],
                      BB_Type_train$Type, prob = TRUE, k = which.max(MeanAcc))
confusionMatrix(table(classifications,BB_Type_test$Type))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                
## classifications Ale IPA
##             Ale  93  19
##             IPA   9  69
##                                           
##                Accuracy : 0.8526          
##                  95% CI : (0.7941, 0.8998)
##     No Information Rate : 0.5368          
##     P-Value [Acc &gt; NIR] : &lt; 2e-16         
##                                           
##                   Kappa : 0.7013          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.08897         
##                                           
##             Sensitivity : 0.9118          
##             Specificity : 0.7841          
##          Pos Pred Value : 0.8304          
##          Neg Pred Value : 0.8846          
##              Prevalence : 0.5368          
##          Detection Rate : 0.4895          
##    Detection Prevalence : 0.5895          
##       Balanced Accuracy : 0.8479          
##                                           
##        &#39;Positive&#39; Class : Ale             
## </code></pre>
<pre class="r"><code>############################### PART 8 CONCLUSION ##############################
#
# Using a KNN Classifier that runs through 100 different training/test sets 
# for 50 k-values, we concluded an ideal k-value is between 4-6.  In this 
# particular instance of the classifier using a k-value of 5 yields an 
# accuracy of about 85%. Therefore we can confidently predict whether a beer 
# is an IPA or an Ale if given the ABV and IBU values.
#
############################### PART 8 CONCLUSION ##############################    



################################### PART 9 #####################################
# 
# 9. Knock their socks off! Find one other useful inference from the data that 
# you feel Budweiser may be able to find value in. You must convince them why it 
# is important and back up your conviction with appropriate statistical evidence. 
# 
################################### PART 9 #####################################

################################### ANDREW #####################################

# Create a data frame from the original Beer data set with only the 
# &quot;Name&quot;, &quot;Style&quot;, &quot;ABV&quot;, and &quot;IBU&quot; columns
Not_Bud_Beer &lt;- BB_Both %&gt;% 
  select(-Beer_ID, -Brewery_id, -Ounces, -Brewery_Name, -City, -State)
Not_Bud_Beer$BudOrNot = &quot;Not&quot;

# Create new data set with Budweiser&#39;s product line of Beers
Bud_Beer &lt;- data.frame(Beer_Name = c(&quot;Budweiser&quot;, &quot;Budweiser Select&quot;, 
                                     &quot;Budweiser Select 55&quot;, 
                                     &quot;Budweiser Black Crown&quot;),
                       ABV = c(&quot;0.050&quot;, &quot;0.043&quot;, &quot;0.024&quot;, &quot;0.060&quot;),
                       IBU = c(&quot;12&quot;, &quot;11&quot;, &quot;10&quot;, &quot;15&quot;),
                       Style = c(&quot;American Pale Lager&quot;, &quot;Light Lager&quot;, 
                                 &quot;Light Lager&quot;, &quot;American Amber / Red Lager&quot;),
                       BudOrNot = c(&quot;Bud&quot;,&quot;Bud&quot;,&quot;Bud&quot;,&quot;Bud&quot;))

# Create a data frame from the original Brewery data set with only the &quot;City&quot;,
# and &quot;Sate&quot;, columns
Not_Bud_Brewery &lt;- Brewery %&gt;% select(-Brew_ID, -Brewery_Name)

# Create new data set with Budweiser&#39;s product line of Beers
Bud_Brewery &lt;- data.frame (City  = c(&quot;Cartersville&quot;, &quot;Columbus&quot;, &quot;Los Angeles&quot;, 
                                     &quot;Fairfield&quot;, &quot;Fairfield&quot;, &quot;Houston&quot;, 
                                     &quot;Jacksonville&quot;, &quot;St. Louis&quot;),
                           State = c(&quot;NY&quot;, &quot;GA&quot;, &quot;OH&quot;, &quot;CA&quot;, &quot;CA&quot;, &quot;TX&quot;, &quot;FL&quot;, 
                                     &quot;MO&quot;))

# combine the original Beer and Brewery data sets with the the Budweiser sets
BB_Bud_Beer = rbind(Not_Bud_Beer, Bud_Beer)
BB_Bud_Brewery &lt;- rbind(Not_Bud_Brewery, Bud_Brewery)

# Using the original data set, summarize what is the most &quot;popular&quot; style of beer
# Create a data table which totals the amount of beers in each style group
Style_Count &lt;- as.data.frame(table(Not_Bud_Beer$Style))

# arrange the Styles from most to least
Style_Count &lt;- arrange(Style_Count, desc(Freq))

# pick out the top 5 most popular styles
TopFiveStyle = head(Style_Count,5)

# Plot a bar chart of the top 5
TopFiveStyle %&gt;% ggplot(aes(x = reorder(Var1, -Freq), y = Freq)) + 
  geom_bar(stat = &quot;identity&quot;, fill=&quot;red&quot;) + 
  labs(title=&quot;Most Popular Style of Beers&quot;, x=&quot;Style&quot;, y=&quot;No. of Beers&quot;) + 
  geom_text(aes(label=Freq), position=position_dodge(width=0.9), vjust=-0.25) + 
  theme(axis.text.x = element_text(vjust = grid::unit(c(-8, -6, -4, -2, 0), &quot;points&quot;)))</code></pre>
<pre><code>## Warning: Vectorized input to `element_text()` is not officially supported.
## Results may be unexpected or may change in future versions of ggplot2.</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-8.png" width="672" /></p>
<pre class="r"><code># Plot the ABV and IBU of all beers to see where Budweiser&#39;s products show up
# and where there is potential opportunity to capture more of the market
Bud_ABVvsIBU &lt;- BB_Bud_Beer %&gt;% select(ABV, IBU, BudOrNot)
ggplot(Bud_ABVvsIBU, aes(x = as.numeric(ABV), y = as.numeric(IBU))) + 
  geom_point(aes(size = BudOrNot, color=BudOrNot)) + 
  scale_size_manual(values=c(10, 3)) +
  geom_smooth(method = lm, se=TRUE, color = &quot;black&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-9.png" width="672" /></p>
<pre class="r"><code>############################# ANDREW CONCLUSION ################################ 
#
# The executives at Budweiser will likely want to know how their own product
# line of beers and breweries matches up to the rest of the data.
# By adding Budweiser&#39;s 4 beers and 8 breweries, we can start to offer some
# insight into potential business areas of opportunity for the company.
#
# If Budweiser was to create a new beer for production, we advise it be:
# An &quot;American IPA&quot; style beer with roughly 6.8% ABV and 50 IBU.
#
# If Budweiser was to open a new brewery for production, we advise it be:
# Located in the state of Colorado.
# 
############################# ANDREW CONCLUSION ################################ 


################################### RAAG #######################################

# I&#39;d like to show how many types of beer&#39;s each state produces in relation to 
# how many breweries each state has. I counted the amount of Breweries and Beers
# in each state, then counted the average ABV and average IBU, and their relative
# region. 

BB_BeerVSBrewery = BB_F_Region %&gt;% 
  select(State, state.region, Brewery_id, Beer_ID, ABV, IBU) %&gt;% 
  group_by(State) %&gt;% 
  summarise(Amt_Brewery = n_distinct(Brewery_id), Amt_Beer = n_distinct(Beer_ID), 
            Avg_ABV = round(mean(ABV),4), Avg_IBU = round(mean(IBU),2),
            Region = state.region[1])


# This graph shows the average ABV and IBU per region, where the size is the
# amount of beers each region makes.

g13 = BB_BeerVSBrewery %&gt;% drop_na() %&gt;% group_by(Region) %&gt;% 
  summarise(abv = mean(Avg_ABV), ibu = mean(Avg_IBU), beers = sum(Amt_Beer)) %&gt;%
  ggplot(aes(x = abv, y = ibu, color = Region)) + geom_point(aes(size = beers)) + 
  labs(x = &quot;Average ABV&quot;, y = &quot;Average IBU&quot;, title = &quot;Average ABV vs Average IBU&quot;, 
       subtitle = &quot;Color based on Region, Size based on amount of Beers&quot;)
  

# This graph shows the amount of different types of Beers and the amount of 
# breweries per state. It is then colored by region, and the size is based off
# of average IBU in each region.

g14 = BB_BeerVSBrewery %&gt;% drop_na() %&gt;% group_by(Region) %&gt;% 
  summarise(beers = sum(Amt_Beer), brews = sum(Amt_Brewery), ibu = mean(Avg_IBU), 
            abv = mean(Avg_ABV)) %&gt;% 
  ggplot(aes(x = beers, y = brews)) + geom_point(aes(size = ibu, 
                                                     color = Region)) + 
  stat_cor(label.x = 200, label.y = 120) + geom_smooth(method = lm, se=FALSE) + 
  labs(x = &quot;Amount of Beers&quot;, y = &quot;Amount of Breweries&quot;, 
       title = &quot;Correlation between the amount of Breweries and Beers&quot;,
       subtitle = &quot;Size based on average IBU, color based on region&quot;)

ggarrange(g13,g14, ncol = 1, nrow = 2)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Project1_files/figure-html/unnamed-chunk-1-10.png" width="672" /></p>
<pre class="r"><code>################################ RAAG CONCLUSION ###############################
#
# There is an incredibly strong relationship between the amount of breweries and
# the amount of beers each state makes. It is also interesting to see that there 
# are significantly more breweries and beers made in the west, compared the 
# northeast. It is also interesting, per region, that the North Central region 
# 
#
################################ RAAG CONCLUSION ###############################



################################## CONCLUSION ##################################
# 
# In conclusion, given a data sets consisting of 2410 Beers and 558 Breweries, 
# we were able to tidy the data, remove unwanted/missing values, calculate a 
# variety of summary statistics, compare trends by state, evaluate the 
# relationship between ABV and IBU, and finally perform additional assessments
# that the executives at Budweiser may find helpful.  Overall, the world of beer
# and breweries covers a vast range of styles and regions.  Budweiser is
# positioned well within the &quot;mainstream&quot; which bodes well for their business
# strategy as the largest mass produced beer company in America.  If they were
# expand their brand, we recommend producing an American IPA with an ABV of 
# around 6.8% to capture a growing consumer interest as well as locating a new
# brewery in the state of Colorado where the opportunities are most plentiful.
# 
################################## CONCLUSION ##################################</code></pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
